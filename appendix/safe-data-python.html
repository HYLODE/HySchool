<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HySchool – safe-data-python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">HySchool</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/tutorials.html">Tutorials</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../hylode/hylode.html">HYLODE</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../faq/faq.html">FAQ</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about/about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">HySchool</a>
  </div>
</li>
          <li class="sidebar-item">
  about.qmd
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Onboarding</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../onboarding/safe-data-tips.html" class="sidebar-item-text sidebar-link">Practical tips</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../emap/uclh-working-with-star.html" class="sidebar-item-text sidebar-link">Working with EMAP star</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/tutorials.html" class="sidebar-item-text sidebar-link">Some tutorials</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/think-bayes.html" class="sidebar-item-text sidebar-link">Think Bayes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/chap01_ex.html" class="sidebar-item-text sidebar-link">Political Views and Parties</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">HYLODE</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/hylode.html" class="sidebar-item-text sidebar-link">HYLODE documentation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/HyMind-Lab-example.html" class="sidebar-item-text sidebar-link">HyMind Lab Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/HyMind-ML-example.html" class="sidebar-item-text sidebar-link">HyMind Machine Learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/HyCastle-Lens.html" class="sidebar-item-text sidebar-link">HyCastle Lens Example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/vignette_0__README.html" class="sidebar-item-text sidebar-link">Hi <em>(Hy?)</em> there…</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/vignette_0_intro.html" class="sidebar-item-text sidebar-link">Exemplar</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/vignette_1_training.html" class="sidebar-item-text sidebar-link">Training data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/vignette_2_modelling.html" class="sidebar-item-text sidebar-link">Modelling</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hylode/vignette_3_data_flow.html" class="sidebar-item-text sidebar-link">Under the hood</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Appendix</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/safe-health-data.html" class="sidebar-item-text sidebar-link">Safe data</a>
  </div>
</li>
          <li class="sidebar-item">
  emap/emap_quick_tour.md
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#working-with-data-at-uclh" id="toc-working-with-data-at-uclh" class="nav-link active" data-scroll-target="#working-with-data-at-uclh">Working with data at UCLH</a>
  <ul class="collapse">
  <li><a href="#five-safes" id="toc-five-safes" class="nav-link" data-scroll-target="#five-safes">Five Safes</a>
  <ul class="collapse">
  <li><a href="#safe-people" id="toc-safe-people" class="nav-link" data-scroll-target="#safe-people">Safe People</a></li>
  <li><a href="#safe-projects" id="toc-safe-projects" class="nav-link" data-scroll-target="#safe-projects">Safe Projects</a></li>
  <li><a href="#safe-settings" id="toc-safe-settings" class="nav-link" data-scroll-target="#safe-settings">Safe Settings</a></li>
  <li><a href="#safe-outputs" id="toc-safe-outputs" class="nav-link" data-scroll-target="#safe-outputs">Safe Outputs</a></li>
  <li><a href="#safe-data" id="toc-safe-data" class="nav-link" data-scroll-target="#safe-data">Safe Data</a></li>
  </ul></li>
  <li><a href="#five-safes-at-uclh" id="toc-five-safes-at-uclh" class="nav-link" data-scroll-target="#five-safes-at-uclh">Five safes at UCLH</a></li>
  </ul></li>
  <li><a href="#safe-data-without-the-other-4-safes" id="toc-safe-data-without-the-other-4-safes" class="nav-link" data-scroll-target="#safe-data-without-the-other-4-safes">Safe data without the other 4 safes</a>
  <ul class="collapse">
  <li><a href="#anonymisation-is-really-hard" id="toc-anonymisation-is-really-hard" class="nav-link" data-scroll-target="#anonymisation-is-really-hard">Anonymisation (is <em>really</em> hard)</a>
  <ul class="collapse">
  <li><a href="#statistical-disclosure-control" id="toc-statistical-disclosure-control" class="nav-link" data-scroll-target="#statistical-disclosure-control">Statistical Disclosure Control</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#safe-outputs-1" id="toc-safe-outputs-1" class="nav-link" data-scroll-target="#safe-outputs-1">Safe outputs</a>
  <ul class="collapse">
  <li><a href="#frequency-tables" id="toc-frequency-tables" class="nav-link" data-scroll-target="#frequency-tables">Frequency tables</a></li>
  <li><a href="#graphs-and-figures" id="toc-graphs-and-figures" class="nav-link" data-scroll-target="#graphs-and-figures">Graphs and Figures</a></li>
  <li><a href="#four-eyes-principle" id="toc-four-eyes-principle" class="nav-link" data-scroll-target="#four-eyes-principle">Four eyes principle</a></li>
  </ul></li>
  <li><a href="#practical-tips" id="toc-practical-tips" class="nav-link" data-scroll-target="#practical-tips">Practical tips</a>
  <ul class="collapse">
  <li><a href="#gitignore-is-your-friend" id="toc-gitignore-is-your-friend" class="nav-link" data-scroll-target="#gitignore-is-your-friend"><code>.gitignore</code> is your friend</a></li>
  <li><a href="#do-not-hard-code-usernames-and-passwords" id="toc-do-not-hard-code-usernames-and-passwords" class="nav-link" data-scroll-target="#do-not-hard-code-usernames-and-passwords">Do not ‘hard code’ usernames and passwords</a>
  <ul class="collapse">
  <li><a href="#load-your-environment-variables-in-python" id="toc-load-your-environment-variables-in-python" class="nav-link" data-scroll-target="#load-your-environment-variables-in-python">Load your environment variables in Python</a></li>
  </ul></li>
  <li><a href="#do-not-leak-from-jupyter-notebooks" id="toc-do-not-leak-from-jupyter-notebooks" class="nav-link" data-scroll-target="#do-not-leak-from-jupyter-notebooks">Do not leak from Jupyter Notebooks</a></li>
  <li><a href="#gitattributes-to-strip-outputs-from-cells-in-a-notebook" id="toc-gitattributes-to-strip-outputs-from-cells-in-a-notebook" class="nav-link" data-scroll-target="#gitattributes-to-strip-outputs-from-cells-in-a-notebook"><code>.gitattributes</code> to strip outputs from cells in a notebook</a></li>
  <li><a href="#for-r" id="toc-for-r" class="nav-link" data-scroll-target="#for-r">For R …</a></li>
  </ul></li>
  <li><a href="#the-end" id="toc-the-end" class="nav-link" data-scroll-target="#the-end">The End</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<div class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;skip&quot;}" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To run videos from Youtube etc</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML, Image</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Acknowledgement to <a href="https://securedatagroup.org">Safe Data Access Professionals Working Group</a><br>
Please review <a href="https://doi.org/10.6084/m9.figshare.9958520">SDC</a> handbook</p>
<div>
<p><img src="figs/sdc-handbook-v1.0-pp1.png" align="right" width="500"></p>
</div>
<section id="working-with-data-at-uclh" class="level1">
<h1>Working with data at UCLH</h1>
<section id="five-safes" class="level2">
<h2 class="anchored" data-anchor-id="five-safes">Five Safes</h2>
<p>We follow the <a href="http://www2.uwe.ac.uk/faculties/BBS/Documents/1601.pdf">‘Five Safes’</a> approach to managing data and information security. This means that we don’t rely on just the ‘safety’ of the data but also take into account the following:</p>
<section id="safe-people" class="level3">
<h3 class="anchored" data-anchor-id="safe-people">Safe People</h3>
<ul>
<li>all individuals have substantive contracts or educational relationships with higher education or NHS institutions</li>
<li>those working need to have evidence of experience of working with such data (e.g.&nbsp;previous training, previous work with ONS, data safe havens etc.) or they need a supervisor who can has similar experience</li>
<li>those working need to undergo training in information governance and issues with statistical disclosure control (SDC)</li>
</ul>
</section>
<section id="safe-projects" class="level3">
<h3 class="anchored" data-anchor-id="safe-projects">Safe Projects</h3>
<ul>
<li>projects must ‘serve the public good’&nbsp;</li>
<li>projects must meet relevant HRA and UCLH research and ethics approvals</li>
<li>service delivery work mandated as per usual trust processes</li>
</ul>
</section>
<section id="safe-settings" class="level3">
<h3 class="anchored" data-anchor-id="safe-settings">Safe Settings</h3>
<ul>
<li>working at UCLH in the NHS on approved infrastructure</li>
<li>UCLH local and remote desktops</li>
<li>UCLH Data Science Desktop</li>
<li>Generic Application Development Environment (GADE)</li>
</ul>
</section>
<section id="safe-outputs" class="level3">
<h3 class="anchored" data-anchor-id="safe-outputs">Safe Outputs</h3>
<ul>
<li>outputs (e.g.&nbsp;reports, figures and tables) must be non-disclosing&nbsp;</li>
<li>outputs should remain on NHS systems initially</li>
<li>a copy of all outputs that are released externally (documents) should be&nbsp;stored in one central location so that there is visibility for all</li>
</ul>
</section>
<section id="safe-data" class="level3">
<h3 class="anchored" data-anchor-id="safe-data">Safe Data</h3>
<ul>
<li>direct identifiers (hospital numbers, NHS numbers, names etc) should be masked unless there is an explicit justification for their use</li>
<li>data releases are proportionate (e.g.&nbsp;limited by calendar periods, by patient cohort etc.)</li>
<li>further work to obscure or mask the data is not necessary given the other safe guards (as per the recommendation by the UK data service)</li>
</ul>
<div class="cell" data-jp-markdownheadingcollapsed="true" data-slideshow="{&quot;slide_type&quot;:&quot;slide&quot;,&quot;tags&quot;:[&quot;to_remove&quot;]}" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>HTML</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>iframe width<span class="op">=</span><span class="st">"560"</span> height<span class="op">=</span><span class="st">"315"</span> src<span class="op">=</span><span class="st">"https://www.youtube.com/embed/Mln9T52mwj0?rel=0&amp;amp;controls=0&amp;amp;showinfo=0"</span> frameborder<span class="op">=</span><span class="st">"0"</span> allowfullscreen<span class="op">&gt;&lt;/</span>iframe<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe width="560" height="315" src="https://www.youtube.com/embed/Mln9T52mwj0?rel=0&amp;controls=0&amp;showinfo=0" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
</section>
<section id="five-safes-at-uclh" class="level2">
<h2 class="anchored" data-anchor-id="five-safes-at-uclh">Five safes at UCLH</h2>
<p>Practically although this means that we are judging your data safety on <em>more</em> than just the qualities of the data, we are able to work with data that would otherwise be considered unsafe. The plot below demonstrates this by comparing the effort we would have to expend on safety if we wanted to release data on the internet. This means that we lose all the other 4 safes.</p>
<p><img src="../figs/five-safes-uclh-radar.png" class="img-fluid"></p>
</section>
</section>
<section id="safe-data-without-the-other-4-safes" class="level1">
<h1>Safe data without the other 4 safes</h1>
<ul>
<li>Anonymisation <code>&lt;-</code></li>
<li>Pseudonymisation</li>
<li>De-identification</li>
</ul>
<section id="anonymisation-is-really-hard" class="level2">
<h2 class="anchored" data-anchor-id="anonymisation-is-really-hard">Anonymisation (is <em>really</em> hard)</h2>
<p>Methods include Generalised Adversarial Networks, differentially-private Bayesian generative models, and Statistical Disclosure Control</p>
<section id="statistical-disclosure-control" class="level3">
<h3 class="anchored" data-anchor-id="statistical-disclosure-control">Statistical Disclosure Control</h3>
<p>Set thresholds for</p>
<ul>
<li><em>k-anonymity</em>: counts the number of individuals identified by the intersection of key variables</li>
<li><em>l-diversity</em>: counts how varied other sensitive fields are within a k-anonymous group</li>
</ul>
<p>Then define</p>
<ul>
<li>direct identifiers</li>
<li>key variables (indirect identifiers)</li>
<li>sensitive fields</li>
<li>non-identifying variables</li>
</ul>
<p><img src="figs/cchic-anon-1.png" class="img-fluid"></p>
<p><img src="figs/cchic-anon-2.png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="safe-outputs-1" class="level1">
<h1>Safe outputs</h1>
<p>Some terminology</p>
<ul>
<li><p>Rules-based &gt; Users are given a set of fixed rules about what can and cannot be released, if the statistical output presented by the user meets the criteria it is released.</p></li>
<li><p>Principles-based &gt; An assessment of risk takes place, and a decision is made as to whether the statistical output presented ‘safe’ to release or not? (in accordance with the Five Safes ‘Safe Output’ element).</p></li>
<li><p>Primary disclosure &gt; Inferring the identity, and/or information about, a data subject from a single source of data. Spontaneous recognition.</p></li>
<li><p>Secondary disclosure (‘attribute’) &gt; Deriving the identity, and/or information of, a data subjecting by combining two or more sources of information together.</p></li>
</ul>
<section id="frequency-tables" class="level2">
<h2 class="anchored" data-anchor-id="frequency-tables">Frequency tables</h2>
<p>Rules-based - Minimum cell count - All counts should be unweighted</p>
<p>Principles-based - Threshold is a ‘rule-of-thumb’ - The units and data being presented should be considered</p>
<p>Frequencies can be presented in many different ways including tables, histograms, pie charts, bar charts. The guidance for frequency tables will also apply for these.</p>
<p><img src="figs/five-safes-freq-table-1.png" class="img-fluid"></p>
<p><img src="figs/five-safes-freq-table-2.png" class="img-fluid"></p>
</section>
<section id="graphs-and-figures" class="level2">
<h2 class="anchored" data-anchor-id="graphs-and-figures">Graphs and Figures</h2>
<p>Example issues include</p>
<ul>
<li>histograms: often low counts in the tails of the distribution, the maximum and minimum values may also be shown.</li>
<li>scatter plots: by definition are plots of individuals (also residual plots); consider grouping</li>
</ul>
<p><img src="figs/five-safes-freq-scatter-1.png" class="img-fluid"></p>
<p><img src="figs/five-safes-freq-scatter-2.png" class="img-fluid"></p>
</section>
<section id="four-eyes-principle" class="level2">
<h2 class="anchored" data-anchor-id="four-eyes-principle">Four eyes principle</h2>
</section>
</section>
<section id="practical-tips" class="level1">
<h1>Practical tips</h1>
<p><img src="figs/safe-ide.png" class="img-fluid"></p>
<section id="gitignore-is-your-friend" class="level2">
<h2 class="anchored" data-anchor-id="gitignore-is-your-friend"><code>.gitignore</code> is your friend</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jupyter Notebook</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">.ipynb_checkpoints</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># secret</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">secret*</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">.env</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># scratches</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">scratch.ipynb</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">Untitled.ipynb</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">labbooks/*</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">tmp/*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="do-not-hard-code-usernames-and-passwords" class="level2">
<h2 class="anchored" data-anchor-id="do-not-hard-code-usernames-and-passwords">Do not ‘hard code’ usernames and passwords</h2>
<p>Use a <code>.env</code> file (or <code>secrets</code> or similar) Exclude from git via <code>.gitignore</code></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># edit this file and replace with actual usernames and passwords</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># then save WITH the dot prefix e.g. env --&gt; .env</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># DO NOT SAVE as env (without the dot prefix) </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># else you will publish your secrets to github</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># environment variables</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="va">EMAP_DB_USER</span><span class="op">=</span>YOUR_USERNAME_HERE</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="va">EMAP_DB_PASSWORD</span><span class="op">=</span>YOUR_PASSWORD_HERE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="load-your-environment-variables-in-python" class="level3">
<h3 class="anchored" data-anchor-id="load-your-environment-variables-in-python">Load your environment variables in Python</h3>
<div class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-tags="[]">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>load_dotenv(<span class="st">'.env'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A template JupyterNotebook for working with data at UCLH. The following features of this notebook, and associated files are documented here to minimise the risk of data leaks or other incidents.</p>
<ul>
<li>Usernames and passwords are stored in a .env file that is excluded from version control. The example <code>env</code> file at <code>./config/env</code> should be edited and saved as <code>./config/.env</code>. A utility function <code>load_env_vars()</code> is provided that will confirm this file exists and load the configuration into the working environment.</li>
<li>.gitattributes are set to strip JupyterNotebook cells when pushing to GitHub</li>
</ul>
<div class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-tags="[]">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_env_vars(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    ENV_FILE_ID <span class="op">=</span> <span class="st">'rainy.fever.song'</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    dotenv_path <span class="op">=</span> <span class="st">'./config/.env'</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                 ):</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Load environment variables or raise error if the file is not found</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    dotenv_path <span class="op">=</span> Path(dotenv_path)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    load_dotenv(dotenv_path<span class="op">=</span>dotenv_path)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.getenv(<span class="st">'ENV_FILE_ID'</span>) <span class="op">!=</span> ENV_FILE_ID:</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">FileNotFoundError</span>(<span class="st">"""</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="st">        IMPORTANT</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="st">        An environment file holding the ENV_FILE_ID variable equal to 'rainy.fever.song'</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="st">        should have been found at the ./config/.env path.</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="st">        Is the script being run from the repository root (emap-helper/)?</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">        Did you convert the example 'env' file to the '.env' file?</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="st">        Please check the above and try again </span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-tags="[]">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_emap_engine(db):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load environment variables</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    load_env_vars()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> db <span class="op">==</span> <span class="st">'uds'</span>:</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># expects to run in HYLODE so these are part of this env</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        host <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_HOST'</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        name <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_NAME'</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        port <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_PORT'</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        user <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_USER'</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        passwd <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_PASSWORD'</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> db <span class="op">==</span> <span class="st">'ids'</span>:</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        host <span class="op">=</span> os.getenv(<span class="st">'IDS_DB_HOST'</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        name <span class="op">=</span> os.getenv(<span class="st">'IDS_DB_NAME'</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        port <span class="op">=</span> os.getenv(<span class="st">'IDS_DB_PORT'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        user <span class="op">=</span> os.getenv(<span class="st">'IDS_DB_USER'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        passwd <span class="op">=</span> os.getenv(<span class="st">'IDS_DB_PASSWORD'</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"db is not recognised; should be one of 'uds' or 'ids'"</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct the PostgreSQL connection</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    emapdb_engine <span class="op">=</span> create_engine(<span class="ss">f'postgresql://</span><span class="sc">{</span>user<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>passwd<span class="sc">}</span><span class="ss">@</span><span class="sc">{</span>host<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>port<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emapdb_engine</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="do-not-leak-from-jupyter-notebooks" class="level2">
<h2 class="anchored" data-anchor-id="do-not-leak-from-jupyter-notebooks">Do not leak from Jupyter Notebooks</h2>
</section>
<section id="gitattributes-to-strip-outputs-from-cells-in-a-notebook" class="level2">
<h2 class="anchored" data-anchor-id="gitattributes-to-strip-outputs-from-cells-in-a-notebook"><code>.gitattributes</code> to strip outputs from cells in a notebook</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">*.ipynb</span> filter=strip-notebook-output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="for-r" class="level2">
<h2 class="anchored" data-anchor-id="for-r">For R …</h2>
<p>Use <code>.Renviron</code> as you would <code>.env</code> but it is automatically ‘read’ by R when it starts</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTANT</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># DO NOT ADD THE .Renviron VERSION OF THIS FILE TO VERSION CONTROL</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># RENAME from dotrenviron to .Renviron in place and then update the</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># environment variables with actual values</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS access</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>IDS_PWD<span class="ot">=</span>foo</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>IDS_HOST<span class="ot">=</span>bar</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>IDS_USER<span class="ot">=</span>me</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># UDS access</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>UDS_PWD<span class="ot">=</span>foo</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>UDS_HOST<span class="ot">=</span>bar</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>UDS_USER<span class="ot">=</span>me</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Internet access</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>http_proxy<span class="ot">=</span>http<span class="sc">:</span><span class="er">//</span>my<span class="sc">-</span>hospital.nhs.uk<span class="sc">:</span><span class="dv">1234</span><span class="sc">/</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>HTTP_PROXY<span class="ot">=</span>http<span class="sc">:</span><span class="er">//</span>my<span class="sc">-</span>hospital.nhs.uk<span class="sc">:</span><span class="dv">1234</span><span class="sc">/</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>https_proxy<span class="ot">=</span>http<span class="sc">:</span><span class="er">//</span>my<span class="sc">-</span>hospital.nhs.uk<span class="sc">:</span><span class="dv">1234</span><span class="sc">/</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>HTTPS_PROXY<span class="ot">=</span>http<span class="sc">:</span><span class="er">//</span>my<span class="sc">-</span>hospital.nhs.uk<span class="sc">:</span><span class="dv">1234</span><span class="sc">/</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># https://rstudio.github.io/renv/articles/docker.html</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>RENV_PATHS_CACHE<span class="ot">=</span><span class="er">/</span>home<span class="sc">/</span>rstudio<span class="sc">/</span>renv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="the-end" class="level1">
<h1>The End</h1>
<p>A template JupyterNotebook for working with data at UCLH. The following features of this notebook, and associated files are documented here to minimise the risk of data leaks or other incidents.</p>
<ul>
<li>Usernames and passwords are stored in a .env file that is excluded from version control. The example <code>env</code> file at <code>./config/env</code> should be edited and saved as <code>./config/.env</code>. A utility function <code>load_env_vars()</code> is provided that will confirm this file exists and load the configuration into the working environment.</li>
<li>.gitattributes are set to strip JupyterNotebook cells when pushing to GitHub</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>